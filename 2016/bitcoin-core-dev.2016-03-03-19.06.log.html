<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>#bitcoin-core-dev log</title>
<style type="text/css">
/* For the .log.html */
pre { /*line-height: 125%;*/
      white-space: pre-wrap; }
body { background: #f0f0f0; }

body .tm  { color: #007020 }                      /* time */
body .nk  { color: #062873; font-weight: bold }   /* nick, regular */
body .nka { color: #007020; font-weight: bold }  /* action nick */
body .ac  { color: #00A000 }                      /* action line */
body .hi  { color: #4070a0 }                 /* hilights */
/* Things to make particular MeetBot commands stick out */
body .topic     { color: #007020; font-weight: bold }
body .topicline { color: #000080; font-weight: bold }
body .cmd       { color: #007020; font-weight: bold }
body .cmdline  { font-weight: bold }

</style>
</head>

<body>
<pre><a name="l-1"></a><span class="tm">19:06:26</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="cmd">#startmeeting</span><span class="cmdline"></span>
<a name="l-2"></a><span class="tm">19:06:26</span><span class="nk"> &lt;lightningbot&gt;</span> Meeting started Thu Mar  3 19:06:26 2016 UTC.  The chair is gmaxwell. Information about MeetBot at http://wiki.debian.org/MeetBot.
<a name="l-3"></a><span class="tm">19:06:26</span><span class="nk"> &lt;lightningbot&gt;</span> Useful Commands: #action #agreed #help #info #idea #link #topic.
<a name="l-4"></a><span class="tm">19:06:33</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">Agenda</span>
<a name="l-5"></a><span class="tm">19:06:52</span><span class="nk"> &lt;gmaxwell&gt;</span> What things need to be discussed today?
<a name="l-6"></a><span class="tm">19:07:21</span><span class="nk"> &lt;CodeShark&gt;</span> Versionbits, segwit status
<a name="l-7"></a><span class="tm">19:08:06</span><span class="nk"> &lt;gmaxwell&gt;</span> okay lets start on versionbits for now and we'll see what else gets raised?
<a name="l-8"></a><span class="tm">19:08:12</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">Versionbits (BIP9)</span>
<a name="l-9"></a><span class="tm">19:08:21</span><span class="nk"> &lt;btcdrak&gt;</span> hi
<a name="l-10"></a><span class="tm">19:08:42</span><span class="nk"> &lt;sipa&gt;</span> i'm about to push a few changes to 7575 (non semantic ones), and it should be ready for review
<a name="l-11"></a><span class="tm">19:08:49</span><span class="nk"> &lt;gmaxwell&gt;</span> Sipa has been working on refining the proposal and has made some recent changes which I think are pretty good-- eliminate some corner cases around start/stop.
<a name="l-12"></a><span class="tm">19:09:12</span><span class="nk"> &lt;btcdrak&gt;</span> The BIP update is looking nice.
<a name="l-13"></a><span class="tm">19:09:15</span><span class="nk"> &lt;CodeShark&gt;</span> Yes, I like the latest changes
<a name="l-14"></a><span class="tm">19:09:16</span><span class="nk"> &lt;sipa&gt;</span> so BIP9 currently guarantees that as long as the start/end times of deployments are non-overlapping, the bits are never ambiguous
<a name="l-15"></a><span class="tm">19:09:44</span><span class="nk"> &lt;sipa&gt;</span> so no need for dependency tracking between different deployments, just choose start/end times sanely
<a name="l-16"></a><span class="tm">19:10:28</span><span class="nk"> &lt;CodeShark&gt;</span> Yes, that's what I had in mind in my implementation but sipa did it better :)
<a name="l-17"></a><span class="tm">19:10:38</span><span class="nk"> &lt;sipa&gt;</span> 7575 currently implements that, and has tests (for the low-level logic, not for the integration with consensus logic)
<a name="l-18"></a><span class="tm">19:11:05</span><span class="nk"> &lt;gmaxwell&gt;</span> I continue to be a little concerned that the activation threshold may be too high considering the low variance triggering mechenism, and activation delay. But I see nothing to do about that except try it and see if our first versionbits fork attempt fails to activate in a reasonable time.
<a name="l-19"></a><span class="tm">19:11:29</span><span class="nk"> &lt;sipa&gt;</span> we can reduce the threshold if needed
<a name="l-20"></a><span class="tm">19:11:49</span><span class="nk"> &lt;sipa&gt;</span> increasing is harder, as it may cause warning to not fire
<a name="l-21"></a><span class="tm">19:12:08</span><span class="nk"> &lt;sdaftuar&gt;</span> <span class="hi">sipa:</span> is 7575 going to eventually include deployment code for BIP68/112/113, or are you going to remove the last commit for a different PR?
<a name="l-22"></a><span class="tm">19:12:27</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">sdaftuar:</span> going to remove the last commit, and replace with whatever is agreed
<a name="l-23"></a><span class="tm">19:12:29</span><span class="nk"> &lt;gmaxwell&gt;</span> Thats a good argument. (that it's easier to reduce the threshold)
<a name="l-24"></a><span class="tm">19:12:47</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">sdaftuar:</span> I have the deployment code done for VB
<a name="l-25"></a><span class="tm">19:13:07</span><span class="nk"> &lt;morcos&gt;</span> <span class="hi">sipa:</span> should the regtest window be smaller than 2016?
<a name="l-26"></a><span class="tm">19:13:19</span><span class="nk"> &lt;sdaftuar&gt;</span> <span class="hi">btcdrak:</span> ok great.  i was just going to say that saving the deployment for a subsequent PR might be easier for reviewing tests, etc
<a name="l-27"></a><span class="tm">19:13:49</span><span class="nk"> &lt;morcos&gt;</span> just seems like it'll make the tests less cumbersome if you want to watch what happens as you go up and down through a couple different windows
<a name="l-28"></a><span class="tm">19:13:50</span><span class="nk"> &lt;btcdrak&gt;</span> I was going to say, regtest with 2016 retarget is cumbersome
<a name="l-29"></a><span class="tm">19:13:55</span><span class="nk"> &lt;gmaxwell&gt;</span> we need to fix regtest to not fall over at retargeting.
<a name="l-30"></a><span class="tm">19:14:01</span><span class="nk"> &lt;sdaftuar&gt;</span> i think that is fixed
<a name="l-31"></a><span class="tm">19:14:03</span><span class="nk"> &lt;morcos&gt;</span> didn't we do that
<a name="l-32"></a><span class="tm">19:14:08</span><span class="nk"> &lt;gmaxwell&gt;</span> oh sorry! :)
<a name="l-33"></a><span class="tm">19:14:10</span><span class="nk"> &lt;sdaftuar&gt;</span> but it still might be cumbersome to generate long chains
<a name="l-34"></a><span class="tm">19:14:18</span><span class="nk"> &lt;sipa&gt;</span> yes, regtest just never changes difficulty now
<a name="l-35"></a><span class="tm">19:14:27</span><span class="nk"> &lt;btcdrak&gt;</span> it's cumbersome to generate long chains, since there are two retarget windows required.
<a name="l-36"></a><span class="tm">19:14:40</span><span class="nk"> &lt;sipa&gt;</span> but good point; i can set the regtest window/threshold lower
<a name="l-37"></a><span class="tm">19:14:49</span><span class="nk"> &lt;cfields&gt;</span> whoops, present. thanks gmaxwell.
<a name="l-38"></a><span class="tm">19:14:51</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">sipa:</span> +1
<a name="l-39"></a><span class="tm">19:14:52</span><span class="nk"> &lt;gmaxwell&gt;</span> why is typing setgenerate 4032 a problem?
<a name="l-40"></a><span class="tm">19:15:01</span><span class="nk"> &lt;sdaftuar&gt;</span> however i also worry that we're no longer testing mainnet parameters, and the consensus parameters are duplicated for each chain
<a name="l-41"></a><span class="tm">19:15:07</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">gmaxwell:</span> you want generate 4032
<a name="l-42"></a><span class="tm">19:15:16</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">gmaxwell:</span> it's too much for RPC tests
<a name="l-43"></a><span class="tm">19:15:24</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">gmaxwell:</span> setgenerate starts the internal miner with the specified number of cores; it no longer has special casing for regtest
<a name="l-44"></a><span class="tm">19:15:28</span><span class="nk"> &lt;morcos&gt;</span> it just takes a little longer...
<a name="l-45"></a><span class="tm">19:15:39</span><span class="nk"> &lt;gmaxwell&gt;</span> I do like to avoid avoidable differences between regtest and mainnet.
<a name="l-46"></a><span class="tm">19:16:16</span><span class="nk"> &lt;gmaxwell&gt;</span> perhaps the answer if it's taking to long is to make regtest even faster?
<a name="l-47"></a><span class="tm">19:16:36</span><span class="nk"> &lt;sipa&gt;</span> reintroduce SSE mining code? :p
<a name="l-48"></a><span class="tm">19:16:44</span><span class="nk"> &lt;btcdrak&gt;</span> :p
<a name="l-49"></a><span class="tm">19:16:52</span><span class="nk"> &lt;gmaxwell&gt;</span> I meant lower the difficulty. :)
<a name="l-50"></a><span class="tm">19:17:07</span><span class="nk"> &lt;morcos&gt;</span> 12 secs
<a name="l-51"></a><span class="tm">19:17:08</span><span class="nk"> &lt;sipa&gt;</span> the regtest difficulty is 1/2000000000
<a name="l-52"></a><span class="tm">19:17:25</span><span class="nk"> &lt;sipa&gt;</span> you can at most get a 2x speedup
<a name="l-53"></a><span class="tm">19:17:38</span><span class="nk"> &lt;morcos&gt;</span> i think it would make the rpc test for this pretty slow as i imagine you'd need to do that many times
<a name="l-54"></a><span class="tm">19:17:50</span><span class="nk"> &lt;gmaxwell&gt;</span> OK, suggestion withdrawn.
<a name="l-55"></a><span class="tm">19:18:08 </span><span class="nka">* paveljanik</span> <span class="ac">is late, sorry</span>
<a name="l-56"></a><span class="tm">19:18:23</span><span class="nk"> &lt;sdaftuar&gt;</span> i worry more that a typo in the mainnet chain's deployment bitmask might go unnoticed/untested
<a name="l-57"></a><span class="tm">19:18:40</span><span class="nk"> &lt;gmaxwell&gt;</span> (why is it so slow? 6 seconds for 4k blocks seems like a lot)
<a name="l-58"></a><span class="tm">19:19:13</span><span class="nk"> &lt;sdaftuar&gt;</span> would anything catch that?
<a name="l-59"></a><span class="tm">19:19:17</span><span class="nk"> &lt;sipa&gt;</span> i'm still fine with lower window for regtest
<a name="l-60"></a><span class="tm">19:19:41</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sdaftuar:</span> review; I guess. (hahaha)
<a name="l-61"></a><span class="tm">19:20:06</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">gmaxwell:</span> it's much slower on RPC tests
<a name="l-62"></a><span class="tm">19:20:40</span><span class="nk"> &lt;sdaftuar&gt;</span> especially if there's stuff in your mempool right?
<a name="l-63"></a><span class="tm">19:21:08</span><span class="nk"> &lt;sdaftuar&gt;</span> blockindex consistency checks and mempool consistency checks both add up i guess
<a name="l-64"></a><span class="tm">19:21:21</span><span class="nk"> &lt;morcos&gt;</span> maybe we didn't fix everything...  blocks 4k -&gt; 8k = 32 secs,   blocks 8k -&gt; 12k = 53 secs
<a name="l-65"></a><span class="tm">19:21:22</span><span class="nk"> &lt;sdaftuar&gt;</span> i'd guess*
<a name="l-66"></a><span class="tm">19:21:30</span><span class="nk"> &lt;btcdrak&gt;</span> yeah it's like 45 seconds for me
<a name="l-67"></a><span class="tm">19:21:32</span><span class="nk"> &lt;sdaftuar&gt;</span> blockindex checks are n^2 no?
<a name="l-68"></a><span class="tm">19:21:38</span><span class="nk"> &lt;sdaftuar&gt;</span> er
<a name="l-69"></a><span class="tm">19:21:45</span><span class="nk"> &lt;morcos&gt;</span> i suppose..  i think we're in the weeds
<a name="l-70"></a><span class="tm">19:21:48</span><span class="nk"> &lt;sdaftuar&gt;</span> yeah sorry
<a name="l-71"></a><span class="tm">19:22:20</span><span class="nk"> &lt;gmaxwell&gt;</span> So, sipa what do you need now for versionbits?
<a name="l-72"></a><span class="tm">19:23:09</span><span class="nk"> &lt;sipa&gt;</span> let me push a few changes, and then review
<a name="l-73"></a><span class="tm">19:23:18</span><span class="nk"> &lt;sipa&gt;</span> and tests are welcome
<a name="l-74"></a><span class="tm">19:23:43</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="cmd">#action </span><span class="cmdline">after sipa pushes a few changes; reivew/test 7575, review BIP9</span>
<a name="l-75"></a><span class="tm">19:24:11</span><span class="nk"> &lt;gmaxwell&gt;</span> Move on to segwit status? anyone have other agenda items to add?
<a name="l-76"></a><span class="tm">19:24:24</span><span class="nk"> &lt;paveljanik&gt;</span> feefilter review etc. please
<a name="l-77"></a><span class="tm">19:24:36</span><span class="nk"> &lt;morcos&gt;</span> and i hae a quick comment on tx backlog
<a name="l-78"></a><span class="tm">19:24:39</span><span class="nk"> &lt;paveljanik&gt;</span> BIP113
<a name="l-79"></a><span class="tm">19:24:58</span><span class="nk"> &lt;gmaxwell&gt;</span> k, lets do txbacklog right now.
<a name="l-80"></a><span class="tm">19:24:58</span><span class="nk"> &lt;Luke-Jr&gt;</span> I still think feefilter should be a little more flexible.
<a name="l-81"></a><span class="tm">19:25:02</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">txbacklog</span>
<a name="l-82"></a><span class="tm">19:25:30</span><span class="nk"> &lt;Luke-Jr&gt;</span> is there one?
<a name="l-83"></a><span class="tm">19:25:33</span><span class="nk"> &lt;morcos&gt;</span> i was wondering what kind of improvements are acceptable for minor releases
<a name="l-84"></a><span class="tm">19:25:37</span><span class="nk"> &lt;paveljanik&gt;</span> s/113/133/
<a name="l-85"></a><span class="tm">19:25:51</span><span class="nk"> &lt;sdaftuar&gt;</span> CPFP mining! :)
<a name="l-86"></a><span class="tm">19:25:56</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">morcos:</span> in response to an urgent problem, i'd say "anything"
<a name="l-87"></a><span class="tm">19:26:03</span><span class="nk"> &lt;morcos&gt;</span> i've noticed block validation seems to have slowed down significantly..  my theory is this is due to the daily cache flush and now many txs in blocks are older than that
<a name="l-88"></a><span class="tm">19:26:09</span><span class="nk"> &lt;morcos&gt;</span> this isn't urgent for sure
<a name="l-89"></a><span class="tm">19:26:12</span><span class="nk"> &lt;sipa&gt;</span> ok
<a name="l-90"></a><span class="tm">19:26:32</span><span class="nk"> &lt;gmaxwell&gt;</span> Right now there has been an increase in tx with fees over 1 satoshi per byte. The months standing background spam load of a around a gigabyte below that seems largely unchanged to me.
<a name="l-91"></a><span class="tm">19:26:36</span><span class="nk"> &lt;morcos&gt;</span> but it seems to me if we can correctly fix the "write but don't flush" aspect of the coinsviewcache, then that should be a significant performance boost
<a name="l-92"></a><span class="tm">19:27:08</span><span class="nk"> &lt;morcos&gt;</span> i guess it depends on whether we think validation times are a significant bottleneck for anything
<a name="l-93"></a><span class="tm">19:27:08</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">morcos:</span> yes...
<a name="l-94"></a><span class="tm">19:27:19</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">morcos:</span> I've noticed the startup checks being much slower and was wondering if we'd made some regression someplace. Haven't tried bisecting.
<a name="l-95"></a><span class="tm">19:27:27</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">morcos:</span> until we change to sending blocks before validating them they do add up
<a name="l-96"></a><span class="tm">19:27:44</span><span class="nk"> &lt;Luke-Jr&gt;</span> has anyone looked into whether the new txs are real or spam?
<a name="l-97"></a><span class="tm">19:28:05</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">Luke-Jr:</span> some people have, petertodd was tweeting some analysis that strongly supported the latter.
<a name="l-98"></a><span class="tm">19:28:08</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">Luke-Jr:</span> yeah, they look like long chains where eventually everything goes back to the sender, apaprently
<a name="l-99"></a><span class="tm">19:28:15</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">Luke-Jr:</span> but no formal writeups exist yet
<a name="l-100"></a><span class="tm">19:28:15</span><span class="nk"> &lt;Luke-Jr&gt;</span> hmm
<a name="l-101"></a><span class="tm">19:28:21</span><span class="nk"> &lt;morcos&gt;</span> heh, you mean short chains..  woo hoo for chain limits!
<a name="l-102"></a><span class="tm">19:28:40</span><span class="nk"> &lt;Luke-Jr&gt;</span> any patterns to identify it with?
<a name="l-103"></a><span class="tm">19:28:40</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">morcos:</span> no, they're long chains - once the txs confirm the chain is extended further
<a name="l-104"></a><span class="tm">19:29:29</span><span class="nk"> &lt;gmaxwell&gt;</span> in general most wallets are responding well (hurray! big improvement from 6 months ago) though not all.
<a name="l-105"></a><span class="tm">19:29:53</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> speaking of, I noticed greenaddress has rbf code in their github repo
<a name="l-106"></a><span class="tm">19:29:57</span><span class="nk"> &lt;morcos&gt;</span> it looks to me like the backlog is diminishing as well
<a name="l-107"></a><span class="tm">19:29:57</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> (for sending)
<a name="l-108"></a><span class="tm">19:30:56</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">petertodd:</span> interesting, yes.. gait has been working on that; I think he was off in a design rathole on how to best support updating with additional outputs.
<a name="l-109"></a><span class="tm">19:31:23</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> yeah, lots of possible ways wallets can do that, some of them quite different from how wallets work right now
<a name="l-110"></a><span class="tm">19:31:24</span><span class="nk"> &lt;gmaxwell&gt;</span> FWIW, with the new proposal for schnorr aggregate signatures, updating for more outputs will be much more attractive.
<a name="l-111"></a><span class="tm">19:31:38</span><span class="nk"> &lt;cfields&gt;</span> <span class="hi">gmaxwell:</span> speaking of, the -mintxfee behavior change may be worth a quick discussion.
<a name="l-112"></a><span class="tm">19:32:06</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">cfields:</span> the -paytxfee change you mean? :)
<a name="l-113"></a><span class="tm">19:32:12</span><span class="nk"> &lt;sipa&gt;</span> (too many fee parameters...)
<a name="l-114"></a><span class="tm">19:32:19</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> oh! that's a good point!
<a name="l-115"></a><span class="tm">19:33:03</span><span class="nk"> &lt;cfields&gt;</span> <span class="hi">sipa:</span> er yes
<a name="l-116"></a><span class="tm">19:33:06</span><span class="nk"> &lt;morcos&gt;</span> i think we just bungled not more clearly announcing the change in semantics for paytxfee
<a name="l-117"></a><span class="tm">19:33:52</span><span class="nk"> &lt;morcos&gt;</span> surprising none of us flagged that as important at the time of the PR...  which does raise another issue, we should have a checklist of things to revisit before release
<a name="l-118"></a><span class="tm">19:34:00</span><span class="nk"> &lt;gmaxwell&gt;</span> Did we know we really changed them? my view on the history was that it was changed to not round a long time ago, but another bug covered it up. That bug was fixed, and no one realized an announcement was needed.
<a name="l-119"></a><span class="tm">19:34:10</span><span class="nk"> &lt;morcos&gt;</span> multiple times now we've said, ok we'll just need to fix that before release, and then forgotten or almost so
<a name="l-120"></a><span class="tm">19:34:24</span><span class="nk"> &lt;morcos&gt;</span> <span class="hi">gmaxwell:</span> oh perhaps?
<a name="l-121"></a><span class="tm">19:34:27</span><span class="nk"> &lt;Luke-Jr&gt;</span> <span class="hi">morcos:</span> well, the change in behaviour is definitely correct
<a name="l-122"></a><span class="tm">19:34:43</span><span class="nk"> &lt;gmaxwell&gt;</span> I'm not sure that even if I realized it was a change I would have put "fee computation more accurate" as high importance-- since mining priority was changed to be precise a really long time ago. (0.6?)
<a name="l-123"></a><span class="tm">19:35:01</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">morcos:</span> when i saw that discussion, i remembered the "fPayAtLeastCustomFee" global and associated problems, but I don't think I ever realized that that global and its default value equal to true was ever released
<a name="l-124"></a><span class="tm">19:35:45</span><span class="nk"> &lt;gmaxwell&gt;</span> yea, I saw that fix but don't think I realized that it was ever in a release. When sipa asked me about paytxfee yesturday I told him it was changed to be accurate forever ago.
<a name="l-125"></a><span class="tm">19:35:56</span><span class="nk"> &lt;gmaxwell&gt;</span> So I think thats the sequence of errors here.
<a name="l-126"></a><span class="tm">19:36:13</span><span class="nk"> &lt;gmaxwell&gt;</span> A checklist would be useful, though I don't know if it would have saved us here.
<a name="l-127"></a><span class="tm">19:36:31</span><span class="nk"> &lt;sipa&gt;</span> so what i think happened is that at some point we switched the mining code to be per byte instead of per kb, later that global was introduced which implicitly retained the behaviour of "rounding up to 1000 bytes for fee calculation" even though the rest of the code was updated to be per byte, and only now, with the global going away, we actually get the accurate change
<a name="l-128"></a><span class="tm">19:36:34</span><span class="nk"> &lt;gmaxwell&gt;</span> asking people to document if a bug being fixed was ever released might have helped.
<a name="l-129"></a><span class="tm">19:36:36</span><span class="nk"> &lt;morcos&gt;</span> yeah , a checklist on changing behavior of any options or rpc calls being properly documented
<a name="l-130"></a><span class="tm">19:36:58</span><span class="nk"> &lt;morcos&gt;</span> another example is -maxsigcachesize
<a name="l-131"></a><span class="tm">19:37:04</span><span class="nk"> &lt;sipa&gt;</span> and i expect that people who made these changes were aware of it, as they updated the rpc tests accordingly, but not review
<a name="l-132"></a><span class="tm">19:37:08</span><span class="nk"> &lt;morcos&gt;</span> i pity the poor fool who has that set to 100000
<a name="l-133"></a><span class="tm">19:37:50</span><span class="nk"> &lt;gmaxwell&gt;</span> you don't have 100 gb ram?
<a name="l-134"></a><span class="tm">19:37:52</span><span class="nk"> &lt;Luke-Jr&gt;</span> ideally we should probably do the release notes in the PR itself
<a name="l-135"></a><span class="tm">19:37:59</span><span class="nk"> &lt;morcos&gt;</span> i'm not sure how many people would catch all these warnings in the 2 foot think binder of release notes, but its still good to have them
<a name="l-136"></a><span class="tm">19:38:37</span><span class="nk"> &lt;gmaxwell&gt;</span> I don't think it was a big deal here, but it could have been one.
<a name="l-137"></a><span class="tm">19:38:37</span><span class="nk"> &lt;sipa&gt;</span> well if we'd have warning for unknown options, we can just switch to a practice of renaming them whenever their meaning changes
<a name="l-138"></a><span class="tm">19:38:41</span><span class="nk"> &lt;CodeShark&gt;</span> make sure to say "WARNING" first so it's searchable :)
<a name="l-139"></a><span class="tm">19:38:57</span><span class="nk"> &lt;btcdrak&gt;</span> yeah I've been meaning to suggest we add at least brief release note documentation in PRs
<a name="l-140"></a><span class="tm">19:39:14</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">btcdrak:</span> i always do (or try to...)
<a name="l-141"></a><span class="tm">19:39:23</span><span class="nk"> &lt;gmaxwell&gt;</span> okay, we're going on a tangent.
<a name="l-142"></a><span class="tm">19:39:36</span><span class="nk"> &lt;sipa&gt;</span> going on a tangent is a sin
<a name="l-143"></a><span class="tm">19:39:41</span><span class="nk"> &lt;gmaxwell&gt;</span> Anything more to say about backlog before we move to talk fee filter?
<a name="l-144"></a><span class="tm">19:39:43</span><span class="nk"> &lt;morcos&gt;</span> oh no
<a name="l-145"></a><span class="tm">19:39:48</span><span class="nk"> &lt;CodeShark&gt;</span> no trig puns
<a name="l-146"></a><span class="tm">19:39:58</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> i co-sign that
<a name="l-147"></a><span class="tm">19:39:58</span><span class="nk"> &lt;gmaxwell&gt;</span> My sides hurt.
<a name="l-148"></a><span class="tm">19:40:00</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">sipa:</span> can you cosign this?
<a name="l-149"></a><span class="tm">19:40:12</span><span class="nk"> &lt;Luke-Jr&gt;</span> lol
<a name="l-150"></a><span class="tm">19:40:23</span><span class="nk"> &lt;Luke-Jr&gt;</span> ♥ sipa
<a name="l-151"></a><span class="tm">19:40:26</span><span class="nk"> &lt;sdaftuar&gt;</span> so how about that fee filter
<a name="l-152"></a><span class="tm">19:40:33</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">feefilter</span>
<a name="l-153"></a><span class="tm">19:40:45</span><span class="nk"> &lt;morcos&gt;</span> it seems to work pretty well
<a name="l-154"></a><span class="tm">19:40:49</span><span class="nk"> &lt;gmaxwell&gt;</span> Feefilter is awesome. I have not yet run it.
<a name="l-155"></a><span class="tm">19:41:00</span><span class="nk"> &lt;Luke-Jr&gt;</span> sorry, I need to run.. I think feefilter at least needs some kind of "mode" for things like "how do we measure size" etc, but not a huge deal
<a name="l-156"></a><span class="tm">19:41:05</span><span class="nk"> &lt;morcos&gt;</span> i mentioned in another context, it reduces tx send and rx bandwidth by around 40+%
<a name="l-157"></a><span class="tm">19:41:28</span><span class="nk"> &lt;gmaxwell&gt;</span> thats fantastic.
<a name="l-158"></a><span class="tm">19:41:28</span><span class="nk"> &lt;morcos&gt;</span> <span class="hi">Luke-Jr:</span> I'm basically of the mindset that we don't introduce complication until we need it
<a name="l-159"></a><span class="tm">19:41:47</span><span class="nk"> &lt;morcos&gt;</span> its totally optional, so no reason not to replace it later with a more generic one if we ever bother implementing
<a name="l-160"></a><span class="tm">19:42:02</span><span class="nk"> &lt;gmaxwell&gt;</span> We will not run out of message types, so we could introduce a modefilter later. I support that thinking.
<a name="l-161"></a><span class="tm">19:42:11</span><span class="nk"> &lt;morcos&gt;</span> it seems to me the message type is the version, yep
<a name="l-162"></a><span class="tm">19:42:19</span><span class="nk"> &lt;gmaxwell&gt;</span> I expect the way relay works to change substantially in the next couple years; so we should probably not overdesign here.
<a name="l-163"></a><span class="tm">19:43:09</span><span class="nk"> &lt;morcos&gt;</span> i need to do a trivial pr rebase, but i guess it just needs more review
<a name="l-164"></a><span class="tm">19:43:23</span><span class="nk"> &lt;morcos&gt;</span> i'm not sure what there is to discuss
<a name="l-165"></a><span class="tm">19:43:38</span><span class="nk"> &lt;gmaxwell&gt;</span> Okay, I will test and review. Thanks for working on this.
<a name="l-166"></a><span class="tm">19:43:50</span><span class="nk"> &lt;morcos&gt;</span> sure
<a name="l-167"></a><span class="tm">19:43:58</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="cmd">#action </span><span class="cmdline">Test and review fee filter. Morcos reports unicorns and rainbows result.</span>
<a name="l-168"></a><span class="tm">19:44:09</span><span class="nk"> &lt;paveljanik&gt;</span> great!
<a name="l-169"></a><span class="tm">19:44:14</span><span class="nk"> &lt;morcos&gt;</span> well all depends on your test setup i guess.. :)
<a name="l-170"></a><span class="tm">19:44:20</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">CPFP mining</span>
<a name="l-171"></a><span class="tm">19:44:31</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sdaftuar:</span> hows it going?
<a name="l-172"></a><span class="tm">19:44:33</span><span class="nk"> &lt;sdaftuar&gt;</span> it's awesome.
<a name="l-173"></a><span class="tm">19:44:53</span><span class="nk"> &lt;sdaftuar&gt;</span> i've been running live for the last two days
<a name="l-174"></a><span class="tm">19:45:16</span><span class="nk"> &lt;btcdrak&gt;</span> The PR number is #7600
<a name="l-175"></a><span class="tm">19:45:20</span><span class="nk"> &lt;sdaftuar&gt;</span> comparing existing mining algorithm to new one
<a name="l-176"></a><span class="tm">19:45:25</span><span class="nk"> &lt;sdaftuar&gt;</span> every ~128 tx's or so
<a name="l-177"></a><span class="tm">19:45:57</span><span class="nk"> &lt;sdaftuar&gt;</span> looking at the last call to CNB before a block is found, i see a 72% increase in fee/block on the last 144 data points
<a name="l-178"></a><span class="tm">19:45:58</span><span class="nk"> &lt;gmaxwell&gt;</span> I believe it should be making some pretty significant differences in selection from what I've seen. A number of users of OTHERBRAND wallet that has no fee estimation and always spends unconfirmed change seem to frequently produce chains of very low fee, very high fee (after realizing they needed more fee from the first tx).
<a name="l-179"></a><span class="tm">19:46:08</span><span class="nk"> &lt;morcos&gt;</span> 72% ?!?!??!
<a name="l-180"></a><span class="tm">19:46:15</span><span class="nk"> &lt;sdaftuar&gt;</span> that could obviously be due to a small number of tx's that aren't getting mined for extended periods
<a name="l-181"></a><span class="tm">19:46:26</span><span class="nk"> &lt;sdaftuar&gt;</span> but geez we need this deployed, i think
<a name="l-182"></a><span class="tm">19:46:41</span><span class="nk"> &lt;btcdrak&gt;</span> amazing
<a name="l-183"></a><span class="tm">19:46:42</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">sdaftuar:</span> i believe that test would result in an exaggerated result
<a name="l-184"></a><span class="tm">19:46:48</span><span class="nk"> &lt;gmaxwell&gt;</span> the effect is likely exagerated due to the pattern I just described: the human controlled fees are exagerating the needed increase.
<a name="l-185"></a><span class="tm">19:47:06</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">sdaftuar:</span> as you're not actually creating blocks on the network with the new CPFP algorithm, i guess?
<a name="l-186"></a><span class="tm">19:47:09</span><span class="nk"> &lt;sdaftuar&gt;</span> yep
<a name="l-187"></a><span class="tm">19:47:10</span><span class="nk"> &lt;sdaftuar&gt;</span> correct
<a name="l-188"></a><span class="tm">19:47:21</span><span class="nk"> &lt;sdaftuar&gt;</span> so if a tx stays around for a day, and isn't selected by the old code, you'd count it over and over
<a name="l-189"></a><span class="tm">19:47:33</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">sdaftuar:</span> meaning that in a real setting, those "better" transactions would be mined once and cleaned up, reducing the effect for later blocks
<a name="l-190"></a><span class="tm">19:47:37</span><span class="nk"> &lt;sipa&gt;</span> right,
<a name="l-191"></a><span class="tm">19:47:37</span><span class="nk"> &lt;sdaftuar&gt;</span> correct
<a name="l-192"></a><span class="tm">19:47:47</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">sdaftuar:</span> how about performance?
<a name="l-193"></a><span class="tm">19:48:01</span><span class="nk"> &lt;sdaftuar&gt;</span> so there are three areas of performance to consider
<a name="l-194"></a><span class="tm">19:48:11</span><span class="nk"> &lt;sdaftuar&gt;</span> one is the additional work of the mempool to keep the index
<a name="l-195"></a><span class="tm">19:48:19</span><span class="nk"> &lt;sdaftuar&gt;</span> another is the part of CNB before TestBlockValidity is called
<a name="l-196"></a><span class="tm">19:48:38</span><span class="nk"> &lt;sdaftuar&gt;</span> and the last is the time TestBlockValidity takes (much larger than the rest of CNB, which is why i think it makes sense to split it out)
<a name="l-197"></a><span class="tm">19:48:58</span><span class="nk"> &lt;gmaxwell&gt;</span> (whom ever makes the lay summary, please don't report 72% increase as what CPFP does; in consideration of sipa's above point about N-fold counting)
<a name="l-198"></a><span class="tm">19:49:19</span><span class="nk"> &lt;sdaftuar&gt;</span> the mempool work isn't really a steady state increase, the concern i think is in what happens when a block is connected
<a name="l-199"></a><span class="tm">19:49:29</span><span class="nk"> &lt;sdaftuar&gt;</span> because then we have to update all the scores for every in-block transaction's descendants
<a name="l-200"></a><span class="tm">19:49:54</span><span class="nk"> &lt;morcos&gt;</span> <span class="hi">gmaxwell:</span> also the previous number he reported to me was 1%.. :)
<a name="l-201"></a><span class="tm">19:50:08</span><span class="nk"> &lt;sdaftuar&gt;</span> (when you add a tx to the mempool, you statically count its ancestors once, so that's basically negligible additional work)
<a name="l-202"></a><span class="tm">19:50:40</span><span class="nk"> &lt;sdaftuar&gt;</span> so i timed that extra delay in mempool.removeForBlock
<a name="l-203"></a><span class="tm">19:50:44</span><span class="nk"> &lt;morcos&gt;</span> but i think it is a good point, that if the increase is sometimes very big, its important for miners to take it...  presumably the average increase wouldn't ever be much different from 0, as we don't see txs permantely residing in mempool
<a name="l-204"></a><span class="tm">19:50:46</span><span class="nk"> &lt;sdaftuar&gt;</span> and reported some numbers in #7594
<a name="l-205"></a><span class="tm">19:51:14</span><span class="nk"> &lt;sdaftuar&gt;</span> looks like what i saw was an increase from an average of 10.9ms to 11.2ms
<a name="l-206"></a><span class="tm">19:51:26</span><span class="nk"> &lt;sdaftuar&gt;</span> that was on half a month's data from october
<a name="l-207"></a><span class="tm">19:51:32</span><span class="nk"> &lt;sdaftuar&gt;</span> er 10 days i guess actually
<a name="l-208"></a><span class="tm">19:52:04</span><span class="nk"> &lt;sdaftuar&gt;</span> so i figure that's negligible enough to not really worry about, especially because if we really cared, we could make block relay happen while the mempool was still being updated, though it'd take some work
<a name="l-209"></a><span class="tm">19:52:13</span><span class="nk"> &lt;gmaxwell&gt;</span> do we worry that CPFP's utility is compromised without package relay? -- I guess these measurements suggest its not.
<a name="l-210"></a><span class="tm">19:52:22</span><span class="nk"> &lt;sdaftuar&gt;</span> moving on to CreateNewBlock's performance:
<a name="l-211"></a><span class="tm">19:52:36</span><span class="nk"> &lt;sdaftuar&gt;</span> vast majority of CNB's total time is taken up by TestBlockValidity
<a name="l-212"></a><span class="tm">19:53:06</span><span class="nk"> &lt;CodeShark&gt;</span> sorry to interrupt - we only have 8 minutes and I wanted to discuss segwit
<a name="l-213"></a><span class="tm">19:53:16</span><span class="nk"> &lt;sdaftuar&gt;</span> somehow, TBV is slightly faster using the new code than the old one.  i haven't dived into it, but my guess is that maybe it's faster to look up mempool inputs than pcoinsTip inputs?
<a name="l-214"></a><span class="tm">19:53:43</span><span class="nk"> &lt;sdaftuar&gt;</span> that speed increase is actually larger than the small hit to performance on the rest of CNB, so it's actually faster in total.  anyway numbers are in the PR #7600
<a name="l-215"></a><span class="tm">19:53:45</span><span class="nk"> &lt;morcos&gt;</span> <span class="hi">gmaxwell:</span> i don't see that as a big concern...  i think it'll likely become common practice to avoid fees so small that they get evicted unless its actual spam.  and CPFP will be useful for when you guess wrong on getting confirmed quickly
<a name="l-216"></a><span class="tm">19:53:46</span><span class="nk"> &lt;sdaftuar&gt;</span> i think this is a clear win
<a name="l-217"></a><span class="tm">19:54:06</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sdaftuar:</span> it sounds great, what now do you think we need to do to move forward?
<a name="l-218"></a><span class="tm">19:54:27</span><span class="nk"> &lt;sdaftuar&gt;</span> review! i broke the work into 3 PR's for review.  one just adds the ancestor feerate index to the mempool (7594)
<a name="l-219"></a><span class="tm">19:54:29</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">morcos:</span> I guess thats one upside over the overly large mempool default size.
<a name="l-220"></a><span class="tm">19:54:38</span><span class="nk"> &lt;sdaftuar&gt;</span> another is by morcos, which refactors CNB
<a name="l-221"></a><span class="tm">19:54:49</span><span class="nk"> &lt;sdaftuar&gt;</span> and then 7600 builds on both with the change to CNB
<a name="l-222"></a><span class="tm">19:55:13</span><span class="nk"> &lt;morcos&gt;</span> <span class="cmd">#7598</span><span class="cmdline"></span>
<a name="l-223"></a><span class="tm">19:55:30</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="cmd">#action </span><span class="cmdline">whip people into wroking on review for CFPF 7594 / 7598 / 7600  it's nicely broken up.</span>
<a name="l-224"></a><span class="tm">19:55:39</span><span class="nk"> &lt;gmaxwell&gt;</span> Can we segwit for CodeShark?
<a name="l-225"></a><span class="tm">19:55:43</span><span class="nk"> &lt;CodeShark&gt;</span> lol
<a name="l-226"></a><span class="tm">19:55:44</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="topic">#topic </span><span class="topicline">segwit status</span>
<a name="l-227"></a><span class="tm">19:55:52</span><span class="nk"> &lt;CodeShark&gt;</span> we had a fork a few days ago
<a name="l-228"></a><span class="tm">19:56:05</span><span class="nk"> &lt;sipa&gt;</span> i haven't had time to investigate
<a name="l-229"></a><span class="tm">19:56:19</span><span class="nk"> &lt;sipa&gt;</span> my hope is that it is caused by miners running older versions of the code
<a name="l-230"></a><span class="tm">19:56:23</span><span class="nk"> &lt;sipa&gt;</span> and not something else
<a name="l-231"></a><span class="tm">19:56:27</span><span class="nk"> &lt;gmaxwell&gt;</span> Time for science then.
<a name="l-232"></a><span class="tm">19:56:43</span><span class="nk"> &lt;CodeShark&gt;</span> that's most probable - but we haven't narrowed down the conditional that actually caused it
<a name="l-233"></a><span class="tm">19:56:48</span><span class="nk"> &lt;sipa&gt;</span> i was planning on doing a segnet4 very soon, but we'd need to understand what's causing this first
<a name="l-234"></a><span class="tm">19:56:59</span><span class="nk"> &lt;morcos&gt;</span> well is there anyone stuck on the short fork?
<a name="l-235"></a><span class="tm">19:57:13</span><span class="nk"> &lt;CodeShark&gt;</span> I think there might still be a few
<a name="l-236"></a><span class="tm">19:57:26</span><span class="nk"> &lt;morcos&gt;</span> seems like would be helpful to know what errors they have and what code they are running
<a name="l-237"></a><span class="tm">19:57:36</span><span class="nk"> &lt;cfields&gt;</span> hmm, i'd be interested in taking a look there. sipa: any helpful references/context ?
<a name="l-238"></a><span class="tm">19:57:45</span><span class="nk"> &lt;gmaxwell&gt;</span> might be useful if regtest networks put their git build info in their version numbers. awful for privacy... but would be useful here.
<a name="l-239"></a><span class="tm">19:57:50</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">cfields:</span> CodeShark probably knows more
<a name="l-240"></a><span class="tm">19:58:10</span><span class="nk"> &lt;gmaxwell&gt;</span> (e.g. a chainparam to put that info in the subver)
<a name="l-241"></a><span class="tm">19:58:11</span><span class="nk"> &lt;cfields&gt;</span> ok. will ping CodeShark after
<a name="l-242"></a><span class="tm">19:58:22</span><span class="nk"> &lt;CodeShark&gt;</span> I think the offending block was something like 22130
<a name="l-243"></a><span class="tm">19:58:26</span><span class="nk"> &lt;CodeShark&gt;</span> or 22132
<a name="l-244"></a><span class="tm">19:58:29</span><span class="nk"> &lt;CodeShark&gt;</span> or somewhere around there
<a name="l-245"></a><span class="tm">19:59:12</span><span class="nk"> &lt;gmaxwell&gt;</span> okay So-- sounds good, a fleet of flying monkies will contemplate the segnet fork.  Posting forked IPs in the segwit IRC channel might get someone's attention.
<a name="l-246"></a><span class="tm">19:59:18</span><span class="nk"> &lt;btcdrak&gt;</span> it's in the logs of #segwit-dev
<a name="l-247"></a><span class="tm">19:59:22</span><span class="nk"> &lt;cfields&gt;</span> ok, thanks
<a name="l-248"></a><span class="tm">19:59:24</span><span class="nk"> &lt;morcos&gt;</span> whats the actual block we're on now?
<a name="l-249"></a><span class="tm">19:59:40</span><span class="nk"> &lt;CodeShark&gt;</span> 22769
<a name="l-250"></a><span class="tm">20:00:06</span><span class="nk"> &lt;CodeShark&gt;</span> https://segnet.smartbit.com.au/ is still stuck on 22153
<a name="l-251"></a><span class="tm">20:00:09</span><span class="nk"> &lt;gmaxwell&gt;</span> okay any emergencies worth going over?
<a name="l-252"></a><span class="tm">20:00:11</span><span class="nk"> &lt;CodeShark&gt;</span> so it's still running he old code
<a name="l-253"></a><span class="tm">20:00:31</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="cmd">#endmeeting</span><span class="cmdline"></span></pre>
</body></html>
