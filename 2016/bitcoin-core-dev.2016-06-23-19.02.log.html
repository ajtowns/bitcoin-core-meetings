<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>#bitcoin-core-dev log</title>
<style type="text/css">
/* For the .log.html */
pre { /*line-height: 125%;*/
      white-space: pre-wrap; }
body { background: #f0f0f0; }

body .tm  { color: #007020 }                      /* time */
body .nk  { color: #062873; font-weight: bold }   /* nick, regular */
body .nka { color: #007020; font-weight: bold }  /* action nick */
body .ac  { color: #00A000 }                      /* action line */
body .hi  { color: #4070a0 }                 /* hilights */
/* Things to make particular MeetBot commands stick out */
body .topic     { color: #007020; font-weight: bold }
body .topicline { color: #000080; font-weight: bold }
body .cmd       { color: #007020; font-weight: bold }
body .cmdline  { font-weight: bold }

</style>
</head>

<body>
<pre><a name="l-1"></a><span class="tm">19:02:40</span><span class="nk"> &lt;wumpus&gt;</span> <span class="cmd">#startmeeting</span><span class="cmdline"></span>
<a name="l-2"></a><span class="tm">19:02:40</span><span class="nk"> &lt;lightningbot&gt;</span> Meeting started Thu Jun 23 19:02:40 2016 UTC.  The chair is wumpus. Information about MeetBot at http://wiki.debian.org/MeetBot.
<a name="l-3"></a><span class="tm">19:02:40</span><span class="nk"> &lt;lightningbot&gt;</span> Useful Commands: #action #agreed #help #info #idea #link #topic.
<a name="l-4"></a><span class="tm">19:03:05</span><span class="nk"> &lt;wumpus&gt;</span> any proposed topics?
<a name="l-5"></a><span class="tm">19:04:01</span><span class="nk"> &lt;wumpus&gt;</span> I think https://github.com/bitcoin/bitcoin/issues/8245 needs discussion, whether reindex/verification slowed down
<a name="l-6"></a><span class="tm">19:04:04</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sdaftuar:</span> sipa: phantomcircuit: jonasschnelli: MarcoFalke: jtimon: phantomcircuit: instagibbs: petertodd: morcos:
<a name="l-7"></a><span class="tm">19:04:08</span><span class="nk"> &lt;sipa&gt;</span> ack topic
<a name="l-8"></a><span class="tm">19:04:11</span><span class="nk"> &lt;gmaxwell&gt;</span> ack.
<a name="l-9"></a><span class="tm">19:04:41</span><span class="nk"> &lt;jtimon&gt;</span> I missed a couple of meetings and I have some questions about merging segwit and 0.13 feature freeze, but maybe that can wait for after the meeting
<a name="l-10"></a><span class="tm">19:04:46</span><span class="nk"> &lt;wumpus&gt;</span> <span class="topic">#topic </span><span class="topicline">perceived validation slowdowns</span>
<a name="l-11"></a><span class="tm">19:04:58</span><span class="nk"> &lt;sipa&gt;</span> i noticed very slow chainstate writes (close to a minute, even though the chainstate is only 53 MB)
<a name="l-12"></a><span class="tm">19:05:03</span><span class="nk"> &lt;gmaxwell&gt;</span> I was just going to go try reindexes with 0.12.1 and master on two hosts, to see if its a regression.  Even if it is not, it's absurdly slow (and I assume for sync too, but that should be validated) and maybe we should consider cranking dbcache and making a release note for loe memory hosts.
<a name="l-13"></a><span class="tm">19:05:13</span><span class="nk"> &lt;sipa&gt;</span> though this may be due to my laptop's disk setup (zfs on encrypted lvm volume)
<a name="l-14"></a><span class="tm">19:05:27</span><span class="nk"> &lt;wumpus&gt;</span> so, some people are noticiing slow validation, I wonder what changed there
<a name="l-15"></a><span class="tm">19:05:29</span><span class="nk"> &lt;gmaxwell&gt;</span> (two identical hosts)
<a name="l-16"></a><span class="tm">19:05:49</span><span class="nk"> &lt;sipa&gt;</span> from gmaxwell's numbers, it does not look like his time is dominated by database flushes, however
<a name="l-17"></a><span class="tm">19:05:57</span><span class="nk"> &lt;gmaxwell&gt;</span> I think I am often guilty of only testing things with a non-default dbcache.
<a name="l-18"></a><span class="tm">19:06:03</span><span class="nk"> &lt;sipa&gt;</span> likewise
<a name="l-19"></a><span class="tm">19:06:12</span><span class="nk"> &lt;gmaxwell&gt;</span> I previously _expected_ reindex to be slow due to the signature checking.
<a name="l-20"></a><span class="tm">19:06:19</span><span class="nk"> &lt;wumpus&gt;</span> I usually run with default dbcache
<a name="l-21"></a><span class="tm">19:06:30</span><span class="nk"> &lt;jtimon&gt;</span> maybe a solution would be to change the default dbcache for something more common among testers?
<a name="l-22"></a><span class="tm">19:06:46</span><span class="nk"> &lt;gmaxwell&gt;</span> my laptop runs with default dbcache and I have been noticing verification is slow for a while, but I have not reindexed for quite a long time.
<a name="l-23"></a><span class="tm">19:06:48</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">jtimon:</span> we still need to figure out what is behind this... but independently, yes
<a name="l-24"></a><span class="tm">19:06:50</span><span class="nk"> &lt;wumpus&gt;</span> yes, we should definitely crank up the dbcache no matter what
<a name="l-25"></a><span class="tm">19:06:53</span><span class="nk"> &lt;wumpus&gt;</span> but I like to know what happened
<a name="l-26"></a><span class="tm">19:07:08</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">sipa:</span> yeah, of course, I meant independently
<a name="l-27"></a><span class="tm">19:07:30</span><span class="nk"> &lt;wumpus&gt;</span> should at least try to bisec tthis, I know it's frustrating as everything takes so long :)
<a name="l-28"></a><span class="tm">19:08:07</span><span class="nk"> &lt;sipa&gt;</span> oh, this is with txindex enabled
<a name="l-29"></a><span class="tm">19:08:14</span><span class="nk"> &lt;gmaxwell&gt;</span> Well I will test against 0.12.1 and see if there is a regression.  oh crap. testing against 0.12.1 will be messed up by signature checking, I guess I will test against patched 0.12.1 that skips signature checking before block 295000? does that sound okay?
<a name="l-30"></a><span class="tm">19:08:18</span><span class="nk"> &lt;wumpus&gt;</span> gmaxwell didn't you have some suspicions that CB would affect initial sync? could that also affect reindex?
<a name="l-31"></a><span class="tm">19:08:24</span><span class="nk"> &lt;wumpus&gt;</span> not in my case
<a name="l-32"></a><span class="tm">19:08:27</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> gmaxwell's test was before cb was merged
<a name="l-33"></a><span class="tm">19:08:57</span><span class="nk"> &lt;gmaxwell&gt;</span> my test is without cb merged, also the CB concern was just related to general sync logic, not processing.
<a name="l-34"></a><span class="tm">19:08:58</span><span class="nk"> &lt;jtimon&gt;</span> are there recent changes that people suspect may have caused the regression ?
<a name="l-35"></a><span class="tm">19:09:07</span><span class="nk"> &lt;wumpus&gt;</span> wouldbe good to test against #7917, as many people benchmarked that
<a name="l-36"></a><span class="tm">19:09:18</span><span class="nk"> &lt;wumpus&gt;</span> and it was perceived fast at the time
<a name="l-37"></a><span class="tm">19:09:40</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> not really
<a name="l-38"></a><span class="tm">19:09:42</span><span class="nk"> &lt;gmaxwell&gt;</span> I can refine further if it looks like a regression.  I think it's likely when I tested 7917 it was with a high dbcache and the result was that things got much faster.
<a name="l-39"></a><span class="tm">19:10:13</span><span class="nk"> &lt;gmaxwell&gt;</span> At least the logs I'm seeing suggest that the slow performace is leveldb performance being slow, so it would be completely hidden by a sufficiently large dbcache.
<a name="l-40"></a><span class="tm">19:10:30</span><span class="nk"> &lt;gmaxwell&gt;</span> (maybe not leveldb itself being slow, e.g. making extranious accesses to it)
<a name="l-41"></a><span class="tm">19:10:47</span><span class="nk"> &lt;wumpus&gt;</span> it may be the windows machine I'm testing on is just crappy, I also had a strange issue with ldb files: https://github.com/bitcoin/bitcoin/issues/8250 .. possible that the disk is just very slow due to other processes interfering
<a name="l-42"></a><span class="tm">19:10:56</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">gmaxwell:</span> note that txindex may actually influence this; the txindex entries are written continuously to the db, and not cached inside the application or batched together with the rist
<a name="l-43"></a><span class="tm">19:11:03</span><span class="nk"> &lt;gmaxwell&gt;</span> So actions are. determine if regression, if so where, ... seperately, consider a dbcache increase for the next release.
<a name="l-44"></a><span class="tm">19:11:08</span><span class="nk"> &lt;wumpus&gt;</span> I doubt it is leveldb itself as there haven't been changed to that for ages
<a name="l-45"></a><span class="tm">19:11:17</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sipa:</span> yes this might be txindex related. I can test that too.
<a name="l-46"></a><span class="tm">19:11:23</span><span class="nk"> &lt;wumpus&gt;</span> yes, txindex is *slow*
<a name="l-47"></a><span class="tm">19:11:24</span><span class="nk"> &lt;CodeShark&gt;</span> is something slowing down validation that wasn't before?
<a name="l-48"></a><span class="tm">19:11:29</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> maybe
<a name="l-49"></a><span class="tm">19:11:32</span><span class="nk"> &lt;wumpus&gt;</span> lots of extra I/O. I also made that mistake once
<a name="l-50"></a><span class="tm">19:11:40</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">wumpus:</span> we have changed (reduced) the amount of interaction with leveldb during validation.
<a name="l-51"></a><span class="tm">19:11:51</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">gmaxwell:</span> sure, it may be the level above leveldb
<a name="l-52"></a><span class="tm">19:12:00</span><span class="nk"> &lt;sipa&gt;</span> yes, it may be
<a name="l-53"></a><span class="tm">19:12:06</span><span class="nk"> &lt;wumpus&gt;</span> I just don't suspect the databse itself this time
<a name="l-54"></a><span class="tm">19:12:34</span><span class="nk"> &lt;gmaxwell&gt;</span> but yes, the only path I see to leveldb itself would just be that it now has more data in it than ever before, and perhaps it crossed some performance cliff. but otherwise, nah.
<a name="l-55"></a><span class="tm">19:12:36</span><span class="nk"> &lt;wumpus&gt;</span> unless some compiler flag changed things shockingly, say, the c++11 switch, but I doubt it
<a name="l-56"></a><span class="tm">19:12:53</span><span class="nk"> &lt;gmaxwell&gt;</span> I think txindex is a good lead, my laptop is the only host I regularly use with it, and I've been noticing poor validation performance for a while.
<a name="l-57"></a><span class="tm">19:13:07</span><span class="nk"> &lt;sipa&gt;</span> i briefly suspected the IsInitialBlockDownload change, but apart from using an atomic, its semantics should be unchanged
<a name="l-58"></a><span class="tm">19:13:19</span><span class="nk"> &lt;wumpus&gt;</span> especialy if you see the slowdown in the flush; txindex writes a lot of data to the block index databse
<a name="l-59"></a><span class="tm">19:13:42</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> but the txindex writes don't happen during the flush
<a name="l-60"></a><span class="tm">19:13:45</span><span class="nk"> &lt;wumpus&gt;</span> so maybe false alarm, the sync is slow, news at 11
<a name="l-61"></a><span class="tm">19:13:59</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> though they may accumulate somewhere in leveldb until a flush is issued
<a name="l-62"></a><span class="tm">19:14:01</span><span class="nk"> &lt;CodeShark&gt;</span> can't we add tracers around calls to narrow it down?
<a name="l-63"></a><span class="tm">19:14:08</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">wumpus:</span> well, the "lets increase the dbcache" is still a useful response to this catching attention again.
<a name="l-64"></a><span class="tm">19:14:31</span><span class="nk"> &lt;sipa&gt;</span> action points: benchmark in same conditions without txindex, and with larger dbcache?
<a name="l-65"></a><span class="tm">19:14:55</span><span class="nk"> &lt;wumpus&gt;</span> yes we should increate the dbcache, and probably change how it is allocated
<a name="l-66"></a><span class="tm">19:15:09</span><span class="nk"> &lt;wumpus&gt;</span> (e.g. a relatively large part now goes to leveldb caches, that's a waste
<a name="l-67"></a><span class="tm">19:15:16</span><span class="nk"> &lt;gmaxwell&gt;</span> (as my laptop is about to be on day three of reindex)
<a name="l-68"></a><span class="tm">19:15:51</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> the reasoning was that leveldb cache is serialized, so it has a much large impact per byte than the internal cache
<a name="l-69"></a><span class="tm">19:15:55</span><span class="nk"> &lt;wumpus&gt;</span> leveldb's own caches are completely ineffective compared to bitcoind's application level cache
<a name="l-70"></a><span class="tm">19:15:59</span><span class="nk"> &lt;sipa&gt;</span> but it has the deserialization overhead
<a name="l-71"></a><span class="tm">19:16:17</span><span class="nk"> &lt;sipa&gt;</span> but that's mostly a guess without substansive benchmarking
<a name="l-72"></a><span class="tm">19:16:18</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">sipa:</span> that makes a lot of sense in theory, but leveldb just sucks at caching :)
<a name="l-73"></a><span class="tm">19:16:43</span><span class="nk"> &lt;gmaxwell&gt;</span> I can benchmark a bunch of mixes of cache sizes and see how they pan out.
<a name="l-74"></a><span class="tm">19:16:53</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> it may also be due to our access pattern... the things that get written to leveldb haven't been touched for a while; maybe they won't be touched any time soon as a result either
<a name="l-75"></a><span class="tm">19:17:04</span><span class="nk"> &lt;wumpus&gt;</span> the current values are probably ok, I just mean: if we scale dbcache we probably don't want to scale those caches with it
<a name="l-76"></a><span class="tm">19:17:10</span><span class="nk"> &lt;jtimon&gt;</span> not sure I'm following but maybe we want separate options for the "internal" and "external" caches?
<a name="l-77"></a><span class="tm">19:17:27</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> for testing that'd be awesome
<a name="l-78"></a><span class="tm">19:17:42</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">jtimon:</span> for testing that makes sense, but as a product it should work well with the fewest number of tunable possible
<a name="l-79"></a><span class="tm">19:17:46</span><span class="nk"> &lt;gmaxwell&gt;</span> In principle we shouldn't add knobs as a punt for highly technical settings that even we haven't figured out, the users will do no better at it. :P  (as hidden options for testing or whatnot, sure)
<a name="l-80"></a><span class="tm">19:17:58</span><span class="nk"> &lt;sipa&gt;</span> jynx
<a name="l-81"></a><span class="tm">19:17:59</span><span class="nk"> &lt;instagibbs2&gt;</span> On phone but present
<a name="l-82"></a><span class="tm">19:18:21</span><span class="nk"> &lt;jtimon&gt;</span> there's some options that can only be accessed if --debug, right?
<a name="l-83"></a><span class="tm">19:18:25</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">gmaxwell:</span> you'd be surprised :-)
<a name="l-84"></a><span class="tm">19:18:35</span><span class="nk"> &lt;wumpus&gt;</span> some users are very persistent in trying to find settings that are fastest for them
<a name="l-85"></a><span class="tm">19:18:48</span><span class="nk"> &lt;CodeShark&gt;</span> I'd venture to say it's probably not the majority
<a name="l-86"></a><span class="tm">19:18:51</span><span class="nk"> &lt;wumpus&gt;</span> but yes, it should be a hidden option (--help-debug)
<a name="l-87"></a><span class="tm">19:18:52</span><span class="nk"> &lt;jtimon&gt;</span> oh, no they may not be showed in the help but they're still accesible I think
<a name="l-88"></a><span class="tm">19:19:00</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">CodeShark:</span> sure, but don't underestimate peole
<a name="l-89"></a><span class="tm">19:19:08</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">wumpus:</span> maybe such options should be marked with ("If you find a setting for this value that improves performance, please let us know")
<a name="l-90"></a><span class="tm">19:19:15</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">sipa:</span> +1 :D
<a name="l-91"></a><span class="tm">19:19:18</span><span class="nk"> &lt;gmaxwell&gt;</span> -funroll-loops -O20
<a name="l-92"></a><span class="tm">19:19:34</span><span class="nk"> &lt;sipa&gt;</span> -femit-broken-code
<a name="l-93"></a><span class="tm">19:20:05</span><span class="nk"> &lt;wumpus&gt;</span> -fskip-computing-even-bits
<a name="l-94"></a><span class="tm">19:20:13</span><span class="nk"> &lt;wumpus&gt;</span> ok, any other topics?
<a name="l-95"></a><span class="tm">19:20:15</span><span class="nk"> &lt;sipa&gt;</span> relatedly, i think -qt can by default use more ram
<a name="l-96"></a><span class="tm">19:20:37</span><span class="nk"> &lt;sipa&gt;</span> also, 100 mb is kinda ridiculous with the mempool already being 300 mb
<a name="l-97"></a><span class="tm">19:20:42</span><span class="nk"> &lt;wumpus&gt;</span> yes, probably, although qt itself also uses more ram
<a name="l-98"></a><span class="tm">19:21:02</span><span class="nk"> &lt;wumpus&gt;</span> yes, agreed
<a name="l-99"></a><span class="tm">19:21:11</span><span class="nk"> &lt;sipa&gt;</span> other topic: merge segwit yay or nay
<a name="l-100"></a><span class="tm">19:21:16</span><span class="nk"> &lt;wumpus&gt;</span> let's reduce the mempool to 100mb and increase dbcache to 300mb
<a name="l-101"></a><span class="tm">19:21:17</span><span class="nk"> &lt;gmaxwell&gt;</span> okay, I have my action items on this. I will benchmark a bunch of configurations. 0.12.1 vs master;  and master  w/wo txindex, w/wo default dbcache.... and also try different cache splits. I may ask for suggestions on the interesting parameter space when I go to do that. If there is a 0.12.1 vs master regression I'll find out where.
<a name="l-102"></a><span class="tm">19:21:38</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> re: segwit, has it been rebased?
<a name="l-103"></a><span class="tm">19:21:45</span><span class="nk"> &lt;wumpus&gt;</span> <span class="topic">#topic </span><span class="topicline">segwit</span>
<a name="l-104"></a><span class="tm">19:21:46</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">petertodd:</span> 12 times by now
<a name="l-105"></a><span class="tm">19:21:50</span><span class="nk"> &lt;CodeShark&gt;</span> lol
<a name="l-106"></a><span class="tm">19:21:53</span><span class="nk"> &lt;sipa&gt;</span> see 8149
<a name="l-107"></a><span class="tm">19:21:55</span><span class="nk"> &lt;CodeShark&gt;</span> poor sipa
<a name="l-108"></a><span class="tm">19:21:55</span><span class="nk"> &lt;jtimon&gt;</span> how can we feature freeze without merging segwit?
<a name="l-109"></a><span class="tm">19:22:03</span><span class="nk"> &lt;wumpus&gt;</span> sipa is getting carpal tunnel syndrome from rebasing
<a name="l-110"></a><span class="tm">19:22:05</span><span class="nk"> &lt;gmaxwell&gt;</span> We can do some checking to see what mempool size should be based on current traffic, in principle I'd agree shifting memory from one to the other.
<a name="l-111"></a><span class="tm">19:22:16</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> softforks / consensus changes don't count as software features
<a name="l-112"></a><span class="tm">19:22:28</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> that's also why they're allowed to be introduced in minor versions
<a name="l-113"></a><span class="tm">19:22:29</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> I mean, is the current pull-req rebased since compact blocks got merged?
<a name="l-114"></a><span class="tm">19:22:32</span><span class="nk"> &lt;gmaxwell&gt;</span> also it's not even activated in any case. it's pure code updates.
<a name="l-115"></a><span class="tm">19:22:35</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">petertodd:</span> yes
<a name="l-116"></a><span class="tm">19:22:49</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">wumpus:</span> so it won't be possible to include any feature post segwit merge in 0.13 ?
<a name="l-117"></a><span class="tm">19:22:52</span><span class="nk"> &lt;CodeShark&gt;</span> current is #8149, yes?
<a name="l-118"></a><span class="tm">19:23:00</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">petertodd:</span> and i've been running the rebase on both testnet (where it syncs segwit blocks) and on mainnet (where it uses compact blocks)
<a name="l-119"></a><span class="tm">19:23:05</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> right, 0.13 is closed feature-wise
<a name="l-120"></a><span class="tm">19:23:52</span><span class="nk"> &lt;gmaxwell&gt;</span> I haven't done CB+segwit testing yet, but I'm due to bring up a new testnet node, so I can do that.
<a name="l-121"></a><span class="tm">19:23:55</span><span class="nk"> &lt;wumpus&gt;</span> features will be merged again on master after a 0.13 branch is created, which will be around the rc1 release (planned july 6 I think)
<a name="l-122"></a><span class="tm">19:24:02</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">wumpus:</span> that is a no, that is unconvenient and I wasn't expecting it, but thanks
<a name="l-123"></a><span class="tm">19:24:34</span><span class="nk"> &lt;wumpus&gt;</span> <span class="cmd">#link </span><span class="cmdline">see the release schedule here: https://github.com/bitcoin/bitcoin/issues/8250</span>
<a name="l-124"></a><span class="tm">19:24:56</span><span class="nk"> &lt;CodeShark&gt;</span> <span class="hi">sipa:</span> which PR should we be testing against?
<a name="l-125"></a><span class="tm">19:24:56</span><span class="nk"> &lt;jtimon&gt;</span> yeah, should have asked "what about segwit?" back then
<a name="l-126"></a><span class="tm">19:25:06</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> 8149 and 7190 are the exact same code
<a name="l-127"></a><span class="tm">19:25:10</span><span class="nk"> &lt;sipa&gt;</span> so whatever you like
<a name="l-128"></a><span class="tm">19:25:44</span><span class="nk"> &lt;gmaxwell&gt;</span> I had completed review up to the CB rebase, which I have not looked at yet.
<a name="l-129"></a><span class="tm">19:26:03</span><span class="nk"> &lt;gmaxwell&gt;</span> (I mean I haven't looked at segwit's rebase for CB)
<a name="l-130"></a><span class="tm">19:26:24</span><span class="nk"> &lt;jtimon&gt;</span> I would have preferred that segwit would have been merged before feature freeze to have time to do something post-segwit for 0.13, but mainly I just wanted to undesrtand the situation
<a name="l-131"></a><span class="tm">19:26:45</span><span class="nk"> &lt;sipa&gt;</span> git show -w c4e3c755d7e41aaabe74c84af7e4bf00a62c96fb
<a name="l-132"></a><span class="tm">19:26:54</span><span class="nk"> &lt;sipa&gt;</span> and then search for cmpctblk and blocktxn
<a name="l-133"></a><span class="tm">19:27:01</span><span class="nk"> &lt;sipa&gt;</span> to see the changes related to that
<a name="l-134"></a><span class="tm">19:27:05</span><span class="nk"> &lt;btcdrak&gt;</span> oh I'm late
<a name="l-135"></a><span class="tm">19:27:21</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">jtimon:</span> we all would have preferred other timings, but we have to cope with how things actually are :)
<a name="l-136"></a><span class="tm">19:27:46</span><span class="nk"> &lt;jtimon&gt;</span> I planned to rebase/rewrite some of the consensus encapsulation code after segwit, I guess the plan doesn't change anyway
<a name="l-137"></a><span class="tm">19:28:02</span><span class="nk"> &lt;wumpus&gt;</span> well you can still do that, it just won't make 0.13
<a name="l-138"></a><span class="tm">19:28:37</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">wumpus:</span> well, yeah, I could have helped more with reviewing and testing segwit
<a name="l-139"></a><span class="tm">19:28:41</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">sipa:</span> thanks, will review once I start up the test panel for the prior topic. :)
<a name="l-140"></a><span class="tm">19:28:48</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">wumpus:</span> understood
<a name="l-141"></a><span class="tm">19:29:07</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">jtimon:</span> you can still do that, even after merge :)
<a name="l-142"></a><span class="tm">19:29:22</span><span class="nk"> &lt;gmaxwell&gt;</span> yes, post merge review and testing is super important too.
<a name="l-143"></a><span class="tm">19:29:44</span><span class="nk"> &lt;wumpus&gt;</span> yes, absolutely
<a name="l-144"></a><span class="tm">19:30:22</span><span class="nk"> &lt;gmaxwell&gt;</span> In any case I am in favor of the merge. (and don't expect my remaining review to turn up any reason not to)
<a name="l-145"></a><span class="tm">19:30:43</span><span class="nk"> &lt;sipa&gt;</span> i'm running the cb+segwit rebase on bitcoin.sipa.be since a few days, to see if there was an impact on memory usage - i see none
<a name="l-146"></a><span class="tm">19:30:48</span><span class="nk"> &lt;gmaxwell&gt;</span> Obviously there may still need to be some fixes and nits. But thats what we have time for.
<a name="l-147"></a><span class="tm">19:30:54</span><span class="nk"> &lt;sipa&gt;</span> (compared to running just cb before)
<a name="l-148"></a><span class="tm">19:30:56</span><span class="nk"> &lt;wumpus&gt;</span> anyone against merging segwit?
<a name="l-149"></a><span class="tm">19:31:03</span><span class="nk"> &lt;wumpus&gt;</span> (I mean right now, not in general)
<a name="l-150"></a><span class="tm">19:32:00</span><span class="nk"> &lt;wumpus&gt;</span> *crickets*
<a name="l-151"></a><span class="tm">19:32:11</span><span class="nk"> &lt;sipa&gt;</span> i have no objections :)
<a name="l-152"></a><span class="tm">19:32:14</span><span class="nk"> &lt;wumpus&gt;</span> that's clear then
<a name="l-153"></a><span class="tm">19:32:17</span><span class="nk"> &lt;btcdrak&gt;</span> I'd like to see it merged too
<a name="l-154"></a><span class="tm">19:32:19</span><span class="nk"> &lt;wumpus&gt;</span> yes, I understood
<a name="l-155"></a><span class="tm">19:32:27</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">sipa:</span> yeah, it just won't make it to 0.13 as wumpus explained
<a name="l-156"></a><span class="tm">19:32:30</span><span class="nk"> &lt;CodeShark&gt;</span> the sooner the better (as long as it doesn't break current behavior)
<a name="l-157"></a><span class="tm">19:32:39</span><span class="nk"> &lt;wumpus&gt;</span> <span class="cmd">#action </span><span class="cmdline">Merge segwit</span>
<a name="l-158"></a><span class="tm">19:32:45</span><span class="nk"> &lt;btcdrak&gt;</span> o/
<a name="l-159"></a><span class="tm">19:33:10</span><span class="nk"> &lt;gmaxwell&gt;</span> at this point it will amplify testing, since we've done a much of the specialized testing. Testing for incidental effects by a broader audience would be good.
<a name="l-160"></a><span class="tm">19:33:26</span><span class="nk"> &lt;instagibbs3&gt;</span> Good.
<a name="l-161"></a><span class="tm">19:34:00</span><span class="nk"> &lt;gmaxwell&gt;</span> Would it be awful to suggest that we put out 'testnet binaries' right away off master to also get more people testing with that code in use?
<a name="l-162"></a><span class="tm">19:34:19</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> fine by me
<a name="l-163"></a><span class="tm">19:34:21</span><span class="nk"> &lt;sipa&gt;</span> i believe jonasschnelli builds nightly binaries
<a name="l-164"></a><span class="tm">19:34:22</span><span class="nk"> &lt;wumpus&gt;</span> sure, why not
<a name="l-165"></a><span class="tm">19:34:47</span><span class="nk"> &lt;wumpus&gt;</span> I prefer doing that outside the 'official' release cycle, but I don't mind running gitian for it
<a name="l-166"></a><span class="tm">19:34:51</span><span class="nk"> &lt;gmaxwell&gt;</span> I think that the prior segnet testing didn't include anyone that was likely to be confused by status changes in the UI or whatnot-- too technical an audience since you had to build it. :)
<a name="l-167"></a><span class="tm">19:35:15</span><span class="nk"> &lt;gmaxwell&gt;</span> yes, I don't want something part of the release cycle. Just binaries to give to power users to give it a spin.
<a name="l-168"></a><span class="tm">19:35:27</span><span class="nk"> &lt;wumpus&gt;</span> testnet-only
<a name="l-169"></a><span class="tm">19:35:51</span><span class="nk"> &lt;CodeShark&gt;</span> testnet as in not segnet, right?
<a name="l-170"></a><span class="tm">19:35:52</span><span class="nk"> &lt;gmaxwell&gt;</span> yea, pre-RC testnet only, we could one line patch to change the default network, so it'll be easier to use.
<a name="l-171"></a><span class="tm">19:36:07</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> segnet has been removed a few weeks ago from the patch
<a name="l-172"></a><span class="tm">19:36:17</span><span class="nk"> &lt;gmaxwell&gt;</span> Testnet is segwit now. Segnet is dead long live segnet.
<a name="l-173"></a><span class="tm">19:36:21</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">gmaxwell:</span> maybe better to just make it fail unless -testnet is enabled, in case someone does run it in production
<a name="l-174"></a><span class="tm">19:36:26</span><span class="nk"> &lt;wumpus&gt;</span> no, not segnet. Regtest could be allowed. But mainnet disabled and testnet as default
<a name="l-175"></a><span class="tm">19:36:32</span><span class="nk"> &lt;CodeShark&gt;</span> is segwit live on testnet?!?!
<a name="l-176"></a><span class="tm">19:36:36</span><span class="nk"> &lt;gmaxwell&gt;</span> yea. exactly.
<a name="l-177"></a><span class="tm">19:36:38</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> yes, since months
<a name="l-178"></a><span class="tm">19:37:01</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">petertodd:</span> what is the worst that could happen if you accidentally run testnet?
<a name="l-179"></a><span class="tm">19:37:14</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">wumpus:</span> hard to know!
<a name="l-180"></a><span class="tm">19:37:39</span><span class="nk"> &lt;gmaxwell&gt;</span> it's just pre-RC master, lots of people do run that in production. I wouldn't worry too much, discretion of whomever makes the testnet-as-default patch?
<a name="l-181"></a><span class="tm">19:37:44</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">wumpus:</span> having to add a -testnet flag isn't a big deal; and failing hard if you don't shouldn't have any consequences
<a name="l-182"></a><span class="tm">19:37:46</span><span class="nk"> &lt;wumpus&gt;</span> at least the default ports etc will be different, default data dir is different, etc
<a name="l-183"></a><span class="tm">19:38:13</span><span class="nk"> &lt;wumpus&gt;</span> <span class="hi">petertodd:</span> apart from GUI users I guess
<a name="l-184"></a><span class="tm">19:38:19</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">petertodd:</span> I hope the user doesn't have to set any flags, if they have to set flags far fewer people will try it.
<a name="l-185"></a><span class="tm">19:38:25</span><span class="nk"> &lt;sipa&gt;</span> i believe this is a nit not worth minutes of discussion time
<a name="l-186"></a><span class="tm">19:38:25</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">wumpus:</span> yes, but imagine someone has an automated system setup which calls bitcoin-cli...
<a name="l-187"></a><span class="tm">19:38:41</span><span class="nk"> &lt;gmaxwell&gt;</span> in any case, can be discussed later or not.
<a name="l-188"></a><span class="tm">19:38:42</span><span class="nk"> &lt;gmaxwell&gt;</span> :)
<a name="l-189"></a><span class="tm">19:38:46</span><span class="nk"> &lt;btcdrak&gt;</span> any more topics?
<a name="l-190"></a><span class="tm">19:40:06</span><span class="nk"> &lt;jtimon&gt;</span> are we merging the bip9 activation parameters for testnet?
<a name="l-191"></a><span class="tm">19:40:27</span><span class="nk"> &lt;CodeShark&gt;</span> hmm - I don't see the activation parameters for segwit on testnet
<a name="l-192"></a><span class="tm">19:40:39</span><span class="nk"> &lt;CodeShark&gt;</span> how can it be live on testnet?
<a name="l-193"></a><span class="tm">19:40:54</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">CodeShark:</span> people running custom code I assume
<a name="l-194"></a><span class="tm">19:40:57</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> in the segwit branch
<a name="l-195"></a><span class="tm">19:41:02</span><span class="nk"> &lt;jtimon&gt;</span> oh
<a name="l-196"></a><span class="tm">19:41:03</span><span class="nk"> &lt;sipa&gt;</span> not in master
<a name="l-197"></a><span class="tm">19:41:20</span><span class="nk"> &lt;btcdrak&gt;</span> <span class="hi">CodeShark:</span> it was activated months ago
<a name="l-198"></a><span class="tm">19:41:44</span><span class="nk"> &lt;CodeShark&gt;</span> yes, but I'm still confused as to the release here
<a name="l-199"></a><span class="tm">19:41:59</span><span class="nk"> &lt;CodeShark&gt;</span> shouldn't testnet only run stuff that's been merged?
<a name="l-200"></a><span class="tm">19:42:11</span><span class="nk"> &lt;instagibbs3&gt;</span> bip 9 activation can still be set.
<a name="l-201"></a><span class="tm">19:42:13</span><span class="nk"> &lt;btcdrak&gt;</span> no, we set the parameters
<a name="l-202"></a><span class="tm">19:42:26</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">CodeShark:</span> we wanted testing in a mixed enviroment with most nodes not upgraded.
<a name="l-203"></a><span class="tm">19:42:26</span><span class="nk"> &lt;btcdrak&gt;</span> and that allowed a miner to activate it
<a name="l-204"></a><span class="tm">19:42:29</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> it was a very useful testing exercise
<a name="l-205"></a><span class="tm">19:42:32</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">CodeShark:</span> since thats realistic.
<a name="l-206"></a><span class="tm">19:42:48</span><span class="nk"> &lt;gmaxwell&gt;</span> and segnet couldn't easily provide that.
<a name="l-207"></a><span class="tm">19:43:00</span><span class="nk"> &lt;CodeShark&gt;</span> sure, I'm all for the additional testing - I'm just concerned about breaking the master builds for testnet
<a name="l-208"></a><span class="tm">19:43:10</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">CodeShark:</span> it's a softfork, hurrah.
<a name="l-209"></a><span class="tm">19:43:18</span><span class="nk"> &lt;sipa&gt;</span> (although, there are so few testnet segwit nodes running right now that it really does not work without -addnode)
<a name="l-210"></a><span class="tm">19:43:19</span><span class="nk"> &lt;jtimon&gt;</span> answer my own question: yes, the testnet activation is part of #7910 : https://github.com/bitcoin/bitcoin/pull/8149/files#diff-64cbe1ad5465e13bc59ee8bb6f3de2e7R191
<a name="l-211"></a><span class="tm">19:43:39</span><span class="nk"> &lt;CodeShark&gt;</span> <span class="hi">gmaxwell:</span> yes, but it will still break miners. however, if no issues arose as a result I'm fine with it
<a name="l-212"></a><span class="tm">19:43:58</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">CodeShark:</span> testnet miners are clearly already running it
<a name="l-213"></a><span class="tm">19:44:05</span><span class="nk"> &lt;CodeShark&gt;</span> yes, indeed
<a name="l-214"></a><span class="tm">19:44:09</span><span class="nk"> &lt;sipa&gt;</span> so how could merging break anything for them?
<a name="l-215"></a><span class="tm">19:44:19</span><span class="nk"> &lt;CodeShark&gt;</span> nvm, all's good
<a name="l-216"></a><span class="tm">19:44:24</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">CodeShark:</span> no issues appear to have arisen.  (also testnet reorgs a lot in any case, so a little instability would have been an issue)
<a name="l-217"></a><span class="tm">19:44:37</span><span class="nk"> &lt;gmaxwell&gt;</span> er, wouldn't have been
<a name="l-218"></a><span class="tm">19:45:02</span><span class="nk"> &lt;jtimon&gt;</span> it is the first time a softfork is activated on testnet before it is in master thought, right?
<a name="l-219"></a><span class="tm">19:45:02</span><span class="nk"> &lt;gmaxwell&gt;</span> in any case, so that would be an action to go with the testnet only builds: get more testnet nodes running upgraded so that it works without addnode.
<a name="l-220"></a><span class="tm">19:45:14</span><span class="nk"> &lt;gmaxwell&gt;</span> Are the testnet seeds running the code that can give filtered responses?
<a name="l-221"></a><span class="tm">19:45:16</span><span class="nk"> &lt;sipa&gt;</span> indeed, and we can test the dns filtering
<a name="l-222"></a><span class="tm">19:45:23</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">gmaxwell:</span> jonasschnelli's is
<a name="l-223"></a><span class="tm">19:45:27</span><span class="nk"> &lt;sipa&gt;</span> not sure about petertodd's
<a name="l-224"></a><span class="tm">19:45:37</span><span class="nk"> &lt;sipa&gt;</span> oh, yes
<a name="l-225"></a><span class="tm">19:45:49</span><span class="nk"> &lt;sipa&gt;</span> https://github.com/bitcoin/bitcoin/pull/8204
<a name="l-226"></a><span class="tm">19:46:49</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">petertodd:</span> are you sure that's running the filtering code?
<a name="l-227"></a><span class="tm">19:46:57</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">gmaxwell:</span> the "testnet only" builds are just from master after merging segwit, right?
<a name="l-228"></a><span class="tm">19:47:02</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">jtimon:</span> yes
<a name="l-229"></a><span class="tm">19:47:02</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> should be
<a name="l-230"></a><span class="tm">19:47:03</span><span class="nk"> &lt;gmaxwell&gt;</span> good okay, so an action right after merge will be to get some more testnet nodes running it spun up, and cooridnate a pre-rc testnet-default/only binary.
<a name="l-231"></a><span class="tm">19:47:10</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> I'll recheck
<a name="l-232"></a><span class="tm">19:47:14</span><span class="nk"> &lt;sipa&gt;</span> x9.seed.tbtc.petertodd.org gives many results, more than i'd expect
<a name="l-233"></a><span class="tm">19:47:32</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> note that it is running with extra args to support rbf
<a name="l-234"></a><span class="tm">19:47:40</span><span class="nk"> &lt;gmaxwell&gt;</span> <span class="hi">jtimon:</span> yes, likely with a trivial patch to change it to default to testnet (or require it). (and maybe a renamed binary)
<a name="l-235"></a><span class="tm">19:47:42</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> so maybe there's a bug there that you haven't run into yet
<a name="l-236"></a><span class="tm">19:48:16</span><span class="nk"> &lt;sipa&gt;</span> <span class="hi">petertodd:</span> can i see the code for that?
<a name="l-237"></a><span class="tm">19:48:24</span><span class="nk"> &lt;jtimon&gt;</span> <span class="hi">gmaxwell:</span> why the changes? aren't this power users?
<a name="l-238"></a><span class="tm">19:48:33</span><span class="nk"> &lt;sipa&gt;</span> after the meeting, please
<a name="l-239"></a><span class="tm">19:48:44</span><span class="nk"> &lt;petertodd&gt;</span> <span class="hi">sipa:</span> it's with the command line arg; which incidentlaly was broken when I tried it (see my pullreq)
<a name="l-240"></a><span class="tm">19:49:02</span><span class="nk"> &lt;gmaxwell&gt;</span> any other topics for this meeting?
<a name="l-241"></a><span class="tm">19:49:31</span><span class="nk"> &lt;wumpus&gt;</span> doesn't seem so
<a name="l-242"></a><span class="tm">19:49:58</span><span class="nk"> &lt;wumpus&gt;</span> <span class="cmd">#endmeeting</span><span class="cmdline"></span></pre>
</body></html>
